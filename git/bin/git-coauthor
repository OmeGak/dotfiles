#!/bin/sh
#
# Prints the "Co-authored-by" trailer falling back to default author name/email.
#
# $1 - The full name of the coauthor.
# $2 - The email address of the coauthor.
#
# Examples
#
#   git coauthor "John Doe" john.doe@example.com

if [ $# -eq 1 ]; then
  echo 'Error: Invalid number of arguments'
  exit 1
fi

author_name=$1
author_email=$2

if [ -z "${author_name}" ] || [ -z "${author_email}" ]; then
  author_name="${GIT_AUTHOR_NAME}"
  author_email="${GIT_AUTHOR_EMAIL}"
fi

if [ -z "${author_name}" ] || [ -z "${author_email}" ]; then
  author_name="$(git config --get user.name)"
  author_email="$(git config --get user.email)"
fi

if [ -z "${author_name}" ] || [ -z "${author_email}" ]; then
  echo 'Error: Missing author information'
  exit 1
fi

echo "Co-authored-by: ${author_name} <${author_email}>"
